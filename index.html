<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		body {
			background-color: grey;
		}
		#out {
			text-align: center;
			width: 500px;
			margin: 50px auto;
		}
	</style>
</head>
	<div id="out"></div>
<body>
	<script
	  src="https://code.jquery.com/jquery-3.2.1.min.js"
	  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	  crossorigin="anonymous">
  </script>
	<script>


	// 1. Get the location


			(function geoFindMe() {
				var output = document.getElementById('out');
				var apiKey = '65e1a3f7909bd8dd36e520691bc2f89c';

				if (!navigator.geolocation) {
					output.innerHTML = '<p>Geolocation is not supported by your browser</p>';
					return;
				}

				function sucess(position) {
					latitude = position.coords.latitude;
					longitude = position.coords.longitude;
					
					$.getJSON(buildURL(latitude, longitude, apiKey), function(json) {

						window.showLocalW =  {
							'city': JSON.stringify(json.name),
							'temperature': convertKelvinToCelsius(JSON.stringify(json.main.temp)),
							'description': JSON.stringify(json.weather[0].description)
						}

						output.innerHTML = 
							'<p>' + 'City: ' + window.showLocalW.city + '<br>' 
							+ 'Temperature: ' + window.showLocalW.temperature + ' &#8451;' + '<br>'
							+ 'Description: ' + window.showLocalW.description + '</p>';

					});



				}

				function error() {
					output.innerHTML = 'Unable to retrive your location';
				}

				function convertKelvinToCelsius(kelvin) {
					var celsius = kelvin - 273;
					return Math.round(celsius);
				}

				function buildURL(latitude, longitude, apiKey) {
					var apiURL = 'http://api.openweathermap.org/data/2.5/weather?lat=' + latitude + '&lon=' + longitude + '&APPID=' + apiKey;
					console.log(apiURL);
			  	return apiURL;
				}

				output.innerHTML = '<p>Locating...</p>';

				navigator.geolocation.getCurrentPosition(sucess, error);

		})();





	// 2. Build the URL
	// 3. Call the API
	// 4. Paint

	</script>
</body>
</html>